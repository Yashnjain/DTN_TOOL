
{% load custom_filters %}
<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fontawesome/4.7.0/css/font-awesome.min.css"> -->

    {% comment %} <link
        href="https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/sticky-header/bootstrap-table-sticky-header.css"
        rel="stylesheet">
    <script
        src="https://unpkg.com/bootstrap-table@1.21.2/dist/extensions/sticky-header/bootstrap-table-sticky-header.min.js"></script> {% endcomment %}

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&family=Noto+Serif:wght@700&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/ityped@0.0.10"></script>
    <script src="https://code.jquery.com/ui/"></script>
    
    <link rel="stylesheet" href="/static/home_0301.css">
    <title>DTN_HOME</title>
    <style>
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
    <script>

        $(document).ready(function () {
            $("input[type=number]").on("focus", function () {
                $(this).on("keydown", function (event) {
                    if (event.keyCode === 38 || event.keyCode === 40) {
                        event.preventDefault();
                    }
                });
            });

            $('.datepicker').datepicker({
                inline: true,
                startDate: '+0d'
            });

        });

        // $( "#datepicker" ).datepicker({ minDate: -2});
    </script>

</head>

<body>
    <!-- // --------------------------------------Table Header Function---------------------------- -->
    <div class="fixed-top" id="header1">
        <header>

            <img src="https://www.biourja.com/wp-content/uploads/BioUrja_Companies_Logos_Retina_Artboard-9.png"
                data-rjs="https://www.biourja.com/wp-content/uploads/BioUrja_Companies_Logos_Retina_Artboard-9.png"
                alt="BioUrja Group" class="sticky-logo" width="80" height="45"
                style="padding-top: 12px; padding-left:15px ; margin-top: 10px;margin-bottom: 10px;">
            <div class="header-left">

                <h1 class="DTN">DTN TOOL</h1>

            </div>

            <div class="header-right">
                <div class="user-info" style="padding-top: 20px;">
                    <img src="https://i1.wp.com/wilcity.com/wp-content/uploads/2020/06/115-1150152_default-profile-picture-avatar-png-green.jpg?fit=820%2C860&ssl=1"
                        alt="User Logo" style="border-color: white; margin-bottom: 10px;">
                    <p>{{request.user}}</p>
                </div>
            </div>
        </header>
        <div>

            {% comment %} <form action="home1" id="form1" style="display: inline-block;">
                <div class="date-container" style="display: inline-block;">
                    <label style="padding-right:10px; margin-left:10px ; display: inline-block;">Select Date:</label>
                    <!-- <input type="date" min="-2" id="date1" onchange="submitForms()"
                        style="padding-bottom: 2px; line-height: 20px;"> -->
                    <select class="Selector-Date" id="date1">
                        <option value="Today" id="date1" selected>Today</option>
                        <option value=""></option>
                    </select>
                </div>
                {% comment %} <input class="btn btn-secondary  cust-btn" type="button" value="Load" href="/load">
                <input class="btn btn-secondary  cust-btn" type="button" value="Save" href="/Save"> {% endcomment %}
             
            {% if  active %}
            <form  action='/' method="get" style="display:inline">
                <input class="btn btn-secondary cust-btn" style="background-color:rgb(164, 245, 82); color: black; font-weight: 600;" type="submit" value="Today" href="/"  onclick="changeCLR(event)">
                </form>
            {% if yesterday_active %}    
            <form  action='/1' method="get" style="display:inline">
            <input class="btn btn-secondary  cust-btn" type="submit"   value="Prev day" href="/1">
            </form>
            {% else %}
            <form  action='/1' method="get" style="display:inline">
                <input class="btn btn-secondary  cust-btn" type="submit"   value="Prev day" href="/1" disabled>
            </form>
            {% endif %}
            {% else %} 
            <form  action='/' method="get" style="display:inline">
                <input class="btn btn-secondary  cust-btn" type="submit" value="Today" href="/"  onclick="changeCLR(event)">
                </form>
            <form  action='/1' method="get" style="display:inline">
            <input class="btn btn-secondary  cust-btn "  style="background-color:rgb(164, 245, 82); color: black;  font-weight: 600;" type="submit" value="Prev day" href="/1">
            </form>
            {% endif %}
            <input class="btn btn-secondary cust-btn"   form="myform" style="display: inline-block;" type="submit" value="Save" href="/submit" onclick="updateSetSize()">          
            {% if  active %}
            {% if  submit_active %}
            <form  action='/submit' method="get" style="display:inline">
            <input  class="btn btn-secondary  cust-btn" type="submit" value="Upload" 
            onclick="if (!confirm('Are you sure you want to Submit ?')) return false; reloadPage()" onclick="reloadPage()">
            </form>
            {% else %}
            <form  action='/submit' method="get" style="display:inline">
                <input  class="btn btn-secondary  cust-btn" type="submit" value="Upload" 
                    onclick="if (!confirm('Are you sure you want to Submit ?')) return false;" disabled>
            </form>
            {% endif %}
            {% else %}
            {% if  submit_active %}
            <form  action='/submit/1' method="get" style="display:inline">
                <input class="btn btn-secondary  cust-btn" type="submit" value="Upload"
                    onclick="if (!confirm('Are you sure you want to Submit ?')) return false; " onclick="reloadPage()">
            </form>
            {% else %}
            <form  action='/submit/1' method="get" style="display:inline">
                <input class="btn btn-secondary  cust-btn" type="submit" value="Upload"
                    onclick="if (!confirm('Are you sure you want to Submit ?')) return false;" disabled>
            </form>
            {% endif %}
            {% endif %}


            <div class="abc1">
                <form method="post" id = "signout" action="/accounts/logout/">
                    {% csrf_token %}
                <a class="button1" onclick="logoutFun()"
                    style="padding:5px; border-top-left-radius: 10px; border-bottom-left-radius: 10px;">


                    <img src="data:image/jpeg;base64,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" style="width: 25px;
                        border-radius: 50px;
                        float: left;">

                     <div class="logout" style="height: 20px;">Logout</div>
                    
                    
                </a>
                
                </form>
            </div>

        </div>

    </div>
    <!-- ----------------------------------------------------------------------Start of Table----------------------------------------------------- -->


    <div class="container tbl-container">
        <div class="row tbl-fixed">
            <form id="myform" action='' method="post">
                {% csrf_token %}
            <table id="myTable">
                <thead>

                    <th scope="col" style="color: azure; background-color: black; ">Location</th>
                    <th scope="col" style="color: azure; background-color: black;">{{today}}</th>
                    <th scope="col" style="color: azure; background-color: black;">{{yesterday}}</th>
                    <th scope="col" style="color: azure; background-color: black;">Difference</th>
                    <th scope="col" style="color: azure; background-color: black;">Status</th>

                    <!-- ---------------------------------Customer Cols Start Here------------------------------- -->
                    {% for l in l_y_p  %}
                        {% if forloop.first %}
                        {% for c in l.customer %}
                 
                    <th scope="col" class="cust-container">{{c.customer_name}} </th>
                        {% endfor %}
                        {% endif %}
                    {% endfor %}
                    
                    </tr>
                </thead>
                <tbody>
                    {% for l in  l_y_p %}

                    <tr class="r1">
                        <td style="line-height:20px;">{{l.location_name}}</td>

                        <div class="calculators" onload="AutoCalc()">

                            {% if  l.new_price %}
                            <td id={{"curr"|add:l.location_id}} style="text-align: center; color: black;">{{l.new_price}}</td>
                            {% else %} 
                            <td id={{"curr"|add:l.location_id}} style="text-align: center; color: black;">{{l.yesterday_price|add_floats:l.price_diff}}</td>
                            {% endif %}

                            <td id={{"prev"|add:l.location_id}}>{{l.yesterday_price}}</td>

                            <!------------------Diff column val ------------------------->

                            <!-- <td><input class="diffText" type="text" id="no1" value="0"
                                    onkeypress="return isNumberKey(this, event); TestFunction();"></td> -->
                            <td>
                                <!-- <td><input type="number" step=any style="width: 100px; white-space: nowrap;" name = {{"L"|add:l.location_id}} value={{l.price_diff}}  ></td> -->
                                <input class="diffText moveFocusDown" type="text" id={{"diff"|add:l.location_id}} value={{l.price_diff}} name = {{"L"|add:l.location_id}}  onfocus="AutoCalc(this) ;"
                                    oninput="checkDecimal(this)">
                            </td>

                        </div>



                        <!--------------------------Status Column------------------- -->
                        {% if  dtnloadsubmit %}
                         <td class="Status">&#x2705;</td> 
                         
                       
                        {% else %} 
                        <td class="Status">&#10060;</td>
                        {% endif %}


                        <!-- ByDefault all the Customers will be disable    or put disable when unchecked else nothing for checked version res will be take care by JS-->

                        <!-- ------------------------------------------Customer column values ---------------------------------- -->
                         {% comment %} <td>
                            <div class="form-check form-check-inline" style="display: block-inline">
                                <input class="form-check-input-inline checkbox" type="checkbox" id="myCheckbox" onclick="isEnable(this)">

                                <!-- Checked version -->
                                <!-- <input  class="form-check-input-inline" type="checkbox" id="myCheckbox" checked
                                    style="margin-right: 3px; display: block-inline; padding-right: 5px;"> -->

                                <!-- <input id="myInput1" type=number style="width: 100px; white-space: nowrap;" step="0.1" disabled > -->

                                <div class="input-group">

                                    <input type="number" id="myInput1" class="cust-inp" value="0"
                                        oninput="checkDecimal(this)" disabled/>
                                    <div class="input-buttons" style="margin-right: 3px;">
                                        <button type="button" class="plus" onclick="increaseValue(event)"></button>
                                        <button type="button" class="button minus"
                                            onclick="decreaseValue(event)"></button>
                                    </div>
                                </div>

                                <!-- Disabled version -->
                                <!-- <input id="myInput1" type=number style="width: 100px; white-space: nowrap;" step="0.1" disabled> -->
                            </div>

                        </td> 
 {% endcomment %}

                        
                        <!-- ------------------------------------------Customer column values ---------------------------------- -->
                        {% for c in l.customer %}
                        <td>
                            <div class="form-check form-check-inline" style="display: block-inline">
                                {% if  c.status %}
                                <input class="form-check-input-inline" type="checkbox" id={{"C"|add:c.ctpm}} checked
                                onclick="isEnable(this)" style="margin-right: 3px; display: block-inline; padding-right: 5px;" name ={{"C"|add:c.ctpm}}>
                                    {% comment %} <input type=number style="width: 80px; white-space: nowrap;" step="0.1" value={{c.price_variance}} name={{"P"|add:c.ctpm}} > {% endcomment %}

                                    <div class="input-group">

                                        <input type="text" id={{"P"|add:c.ctpm}} class="cust-inp" value={{c.price_variance}}
                                           name={{"P"|add:c.ctpm}} oninput="checkDecimal(this)"/>
                                        <div class="input-buttons" style="margin-right: 3px;">
                                            <button type="button" class="plus" id={{"ADD"|add:c.ctpm}} onclick="increaseValue({{c.ctpm}})"></button>
                                            <button type="button" class="button minus" id={{"SUB"|add:c.ctpm}}
                                                onclick="decreaseValue({{c.ctpm}})"></button>
                                        </div>
                                    </div>   

                                {% else %} 
                                <input class="form-check-input-inline" type="checkbox" id={{"C"|add:c.ctpm}} unchecked
                                onclick="isEnable(this)" style="margin-right: 3px; display: block-inline; padding-right: 5px;" name ={{"C"|add:c.ctpm}}>
                                    {% comment %} <input type=number style="width: 80px; white-space: nowrap;" step="0.1" value={{c.price_variance}} name={{"P"|add:c.ctpm}} disable> {% endcomment %}


                                    <div class="input-group">

                                        <input type="text" id={{"P"|add:c.ctpm}} class="cust-inp" value={{c.price_variance}}
                                           name={{"P"|add:c.ctpm}} oninput="checkDecimal(this)" disabled/>
                                        <div class="input-buttons" style="margin-right: 3px;">
                                            <button type="button" class="plus" id={{"ADD"|add:c.ctpm}} onclick="increaseValue({{c.ctpm}})"></button>
                                            <button type="button" class="button minus" id={{"SUB"|add:c.ctpm}}
                                                onclick="decreaseValue({{c.ctpm}})"></button>
                                        </div>
                                    </div>   
                                {% endif %}
                            </div>

                        </td>
                        {% endfor %}
                        <!-- ------------------------------------------Customer column values ---------------------------------- -->
                       

                        </td>

                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </form> 
        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    {% comment %} <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script> {% endcomment %}
</body>
<script>
  
     
    var set1 = new Set();
    var set_size=0;



  function AutoCalc(event) {
        console.log(event.id);
        // var id1="diff"+arg;
        // var a = document.getElementById(id1);

        //get variable part from event id
        var id1=event.id;
        var num=id1.match(/\d+/)[0] 
        var prev="prev"+num; 
        var curr="curr"+num;  
        

        var c;
        var a = document.getElementById(event.id);
        var b = document.getElementById(prev);
        // var number = document.getElementById("number");
        var m = document.getElementById(curr);
        m.innerHTML = b.innerHTML;
        m.innerHTML = m.innerHTML.toString().replace(/(\.\d*?[1-9])0+$/, '$1').replace(/\.$/, '');
       // a.onkeyup = function () {
      //      var c;
    //        if (isNaN(a.value) == false) {
                // c = (parseInt(a.value) || 0) + (parseInt(b.value) || 0);
                // m.innerHTML = parseFloat(parseFloat(a.value)) + parseFloat(parseFloat(b.innerText));
    //            m.innerText = (parseFloat(a.value || 0) + parseFloat(b.innerText || 0)).toFixed(4);
   //             m.innerText = m.innerText.replace(/(\.\d*?[1-9])0+$/, '$1').replace(/\.0*$/, '');
  //          }
 //       }
         a.onkeyup = function () {            if (!isNaN(a.value)) {                var result = parseFloat(a.value || 0) + parseFloat(b.innerText || 0);                if (result >= 0) {                    m.innerText = result.toFixed(4);                    m.innerText = m.innerText.replace(/(\.\d*?[1-9])0+$/, '$1').replace(/\.0*$/, '');                } else {                    a.value = 0.0;                    alert("Please enter a Valid value");                }            }        }
        b.onkeyup = function () {

            if (isNaN(b.value) == false) {
                // c = (parseInt(a.value) || 0) + (parseInt(b.value) || 0);
                // c = parseFloat(parseInt(a.value) || 0) + (parseInt(b.innerText) || 0);
                // m.innerText = c;
                // m.innerHTML = parseFloat(parseFloat(a.value)) + parseFloat(parseFloat(b.innerText));
                // m.innerText = (parseFloat(a.value ||0) + parseFloat(b.innerText||0)).toFixed(6);

                // m.innerText = (parseFloat(a.value ||0) + parseFloat(b.innerText||0)).toFixed(6).toString().replace(/(\.\d*?[1-9])0+$/,'$1').replace(/\.$/,'');

                m.innerText = (parseFloat(a.value || 0) + parseFloat(b.innerText || 0)).toFixed(6);
                m.innerText = m.innerText.replace(/(\.\d*?[1-9])0+$/, '$1').replace(/\.0*$/, '');
            }
        }

    } 

    document.addEventListener('keydown', function(event) {
        var element = event.target;
        var tagName = element.tagName.toLowerCase();
        
        if (event.keyCode === 9 && tagName === 'input' && element.classList.contains('moveFocusDown')) {
          var table = document.getElementById("myTable");
          var rowNum = element.parentNode.parentNode.rowIndex;
          var colNum = element.parentNode.cellIndex;
          var nextRow = table.rows[rowNum+1];
          if (nextRow) {
            var nextInput = nextRow.cells[colNum].querySelector('input');
            if (nextInput) {
                console.log("Inside function");
              event.preventDefault();
              nextInput.focus();
              nextInput.click();
            }
          }
        }
      });

    function isEnable(event) {
        console.log(event.id);
        var a = event.id;
        var num=a.match(/\d+/)[0] 
        var cstinput =  "P" + num;  
        console.log(cstinput);  
        var checkbox = document.getElementById(a);
        var input = document.getElementById(cstinput);
        // input.setAttribute("disabled", "disabled");
        checkbox.addEventListener("change", function () {
            if (this.checked) {
                input.removeAttribute("disabled");
            } else {
                input.setAttribute("disabled", "disabled");
            }
        });
    }


    const inputFields = document.querySelectorAll('input');
    
    var regex = /^(?!C)\w+$/;
    inputFields.forEach(input => {
        input.addEventListener('change', () => {
            console.log(`Input field with id ${input.id} was clicked`);
            if(input.id && regex.test(input.id))
            {
                set1.add(input.id);
            }

            var newValue = input.value || 0;
            input.value = newValue;

       

        });
    });
  
    function Test1(para)
    {
    console.log(para);
    }

    function updateSetSize(){
    
        set_size=set1.size;
    }

    // Javascript for custom step function
    function increaseValue(num) {

        var cstinput2="P"+num;
        console.log(cstinput2);

        inputField = document.getElementById(cstinput2);
        
        if (!(inputField.disabled)) {
            var value = parseFloat(document.getElementById(cstinput2).value);
            value = isNaN(value) ? 0 : value;
            value = value + parseFloat(0.1);

            value = value.toFixed(4);
            value = value.replace(/(\.\d*?[1-9])0+$/, '$1').replace(/\.0*$/, '');
            document.getElementById(cstinput2).value = value;
        }
        //   m.innerText = (parseFloat(a.value || 0) + parseFloat(b.innerText || 0)).toFixed(6);
        // m.innerText = m.innerText.replace(/(\.\d*?[1-9])0+$/,'$1').replace(/\.0*$/,'');
    }

    function decreaseValue(num) {

        var cstinput1 ="P"+num;   
        console.log(cstinput1);
        inputField = document.getElementById(cstinput1);
        if (!(inputField.disabled)) {
            var value = parseFloat(document.getElementById(cstinput1).value);
            value = isNaN(value) ? 0 : value;
            value = value - parseFloat(0.1);

            value = value.toFixed(4);
            value = value.replace(/(\.\d*?[1-9])0+$/, '$1').replace(/\.0*$/, '');
            document.getElementById(cstinput1).value = value;
        }
    }
   

    //function to prevent digits after 4 places of decimal point
    function checkDecimal(input) {
        var value = input.value;
       // var regex = /^-?\d+(\.\d{0,4})?$/; // regex to match up to 4 decimal places
        var regex = /^-?\d*(\.\d{0,4})?$/; // updated ragex for minus
        if (!regex.test(value)) {
            input.value = value.slice(0, -1); // remove the last character if it's invalid
        }
    }

    {% comment %} Form for passing selected data  {% endcomment %}

    function post_selected()
    {
        const form = document.querySelector('form');
    const formData = new FormData();

    // Append only selected input fields to the formData object   // run this in a loop as much time as the size of set1
    //formData.append('diff1', ('#diff1').value);
    formData.append('P202', ('#P202').value);
    formData.append("csrfmiddlewaretoken","4a2cRzgo12FQSrfH9wsNxut9UXM3C4EjEZdWj1cn7UFvBxH7pqVKO1kUhOxjWbS8")
    //formData.append('field2', form.querySelector('#diff23').value);

    // Send the POST request using fetch()
    fetch('http://localhost:8000/', {
    method: 'POST',
    body: formData
    })
    .then(response => {
    // handle response
    })
    .catch(error => {
    // handle error
    });

    }

    {% comment %} const form = document.querySelector('form');
    const formData = new FormData();

    // Append only selected input fields to the formData object   // run this in a loop as much time as the size of set1
    formData.append('field1', form.querySelector("#P202").value);
    formData.append('field2', form.querySelector('#diff23').value);

    // Send the POST request using fetch()
    fetch('/url/to/post', {
    method: 'POST',
    body: formData
    })
    .then(response => {
    // handle response
    })
    .catch(error => {
    // handle error
    });

    To pass only selected input fields of a form in a POST request using JavaScript, you can create a new FormData object, append only the desired input fields to it, and use fetch() or XMLHttpRequest to send the POST request.

    In this example, we first select the form element and create a new FormData object. We then append only the desired input fields to the formData object using their id attributes and the value property of the input elements.

    Finally, we use fetch() to send the POST request to the desired URL, passing the formData object as the body of the request.

    Note that in the example above, we're using the fetch() function, but you could also use XMLHttpRequest or any other method for making HTTP requests in JavaScript. {% endcomment %}
    function reloadPage()
     { 
        location.reload();
    }
    


    // Function to hide header when scroll down

    {% comment %} var prevScrollpos = window.pageYOffset;
    window.onscroll = function () {
        var currentScrollPos = window.pageYOffset;
        if (prevScrollpos > currentScrollPos) {
            document.getElementById("header1").style.top = "0";
        } else {
            document.getElementById("header1").style.top = "-4vh";
        }
        prevScrollpos = currentScrollPos;
    } {% endcomment %}

    // window.ityped.init(document.querySelector('.ityped'),{
    //         strings: ['Welcome To DTN PRICE tool Please Enter your price Carefully!'],
    //         loop: true
    //     })


    // inputFields = document.querySelectorAll('input');
    // if(inputFieldset.active)
    // {
    //     documen
    // }

    //    Two Form submit using one button 

    {% comment %} function submitForms() {
        // document.getElementById("form1").submit();
        // document.getElementById("form2").submit();
        console.log("function invoked")
    } {% endcomment %}


    //Code to Set Todays Date
    {% comment %} var now = new Date();
    var day1 = ("0" + now.getDate()).slice(-2);
    var month2 = ("0" + (now.getMonth() + 1)).slice(-2);
    var today = now.getFullYear() + "-" + (month2) + "-" + (day1);
    date1.value = today;
    date1.innerText = today;
    console.log(date1.value); {% endcomment %}

    window.addEventListener('beforeunload', function (e) {
        if(set1.size!=set_size)
        {
             // Cancel the event            
             e.preventDefault();
        // Chrome requires returnValue to be set        
        e.returnValue = '';
        // Display the confirmation dialog       
         var confirmationMessage = 'Are you sure you want to leave the Page?';
        (e || window.event).returnValue = confirmationMessage; // For IE and Firefox       
        return confirmationMessage; // For Safari        
    }
    });

    function logoutFun()
    {
        document.getElementById("signout").submit();
    }
</script>

</html>